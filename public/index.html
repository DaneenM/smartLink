<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SmartLink Generator</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <img src="logo.png" alt="SmartLink Logo" class="logo" />
  <h1>SmartLink.io</h1>
  <div class="tagline">Track smarter. Share better.</div>

  <!-- Standard SmartLink Form -->
  <div class="container" id="standardForm">
    <form id="linkForm">
      <label>
        <strong>Destination URL (real website):</strong>
        <input type="url" id="targetURL" placeholder="https://example.com" required autocomplete="url" />
        <div class="desc">This is where the link sends someone after tracking.</div>
      </label>

      <label>
        <strong>Custom Path (optional):</strong>
        <input type="text" id="customPath" placeholder="e.g., apple-launch" autocomplete="off" />
        <div class="desc">This is how your SmartLink will look ‚Äî like /apple-launch</div>
      </label>

      <label>
        <strong>Custom Query (optional):</strong>
        <input type="text" id="customQuery" placeholder="e.g., campaign2025=true" autocomplete="off" />
        <div class="desc">Optional query string to make the link look real (like ?promo=true)</div>
      </label>

      <button type="submit">Generate SmartLink</button>
      <button type="button" class="clear-btn" onclick="clearForm()">Clear Form</button>
    </form>

    <div id="output"></div>
    <div id="copyMessage" class="copy-msg"></div>
  </div>

  <!-- AI Persona Generator Feature -->
  <div class="container" style="margin-top: 40px;">
    <h3>üß† Create a Social Persona</h3>
    <p style="font-size: 14px; color: #ccc; margin-bottom: 10px;">Use AI to build a realistic-looking profile for Instagram, TikTok, Facebook, X, or OnlyFans.</p>

    <label>
      <strong>Platform:</strong>
      <select id="platformSelect">
        <option value="instagram">Instagram</option>
        <option value="tiktok">TikTok</option>
        <option value="facebook">Facebook</option>
        <option value="x">X (Twitter)</option>
        <option value="onlyfans">OnlyFans</option>
      </select>
    </label>

    <label><strong>First Name (optional):</strong><input type="text" id="firstName" placeholder="e.g., First name" /></label>
    <label><strong>Last Name (optional):</strong><input type="text" id="lastName" placeholder="e.g., Last name" /></label>
    <label><strong>Username Inspiration or Nickname:</strong><input type="text" id="nickname" placeholder="e.g., glamqueen or badgyal" /></label>
    <label><strong>Age:</strong><input type="number" id="age" placeholder="e.g., 28" /></label>
    <label><strong>Location (City, Country):</strong><input type="text" id="location" placeholder="e.g., Miami, USA" /></label>
    <label><strong>Occupation or Niche:</strong><input type="text" id="niche" placeholder="e.g., Fashion Model or Fitness Coach" /></label>
    <label><strong>Style or Vibe:</strong><input type="text" id="style" placeholder="e.g., Luxury | Trendy | Boho | Streetwear" /></label>
    <label><strong>Follower Count (optional):</strong><input type="text" id="followers" placeholder="e.g., 10K, 150K, 1M" /></label>

    <button onclick="generatePersona()">Generate Fake Profile</button>
    <button onclick="clearPersonaForm()" style="margin-top: 10px; background-color: #dc3545; color: white; border: none; padding: 8px 14px; border-radius: 6px; cursor: pointer;">Start Over</button>

    <div id="personaPreview" class="persona-sample" style="display:none; margin-top: 20px; text-align: center; background-color: #1c1f26; padding: 20px; border-radius: 12px;">
      <img id="profileImage" src="placeholder.png" alt="Profile" style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover; margin-bottom: 10px;">
      <h4 id="previewUsername"></h4>
      <p id="previewName"></p>
      <p id="previewBio"></p>
      <p><strong>Platform:</strong> <span id="previewPlatform"></span></p>
      <p><strong>Location:</strong> <span id="previewLocation"></span></p>
      <p><strong>Style:</strong> <span id="previewStyle"></span></p>
    </div>

    <div id="personaOutput" class="desc" style="margin-top: 16px;"></div>
  </div>

  <script>
    function clearForm() {
      document.getElementById('targetURL').value = '';
      document.getElementById('customPath').value = '';
      document.getElementById('customQuery').value = '';
      document.getElementById('output').innerHTML = '';
      document.getElementById('copyMessage').innerText = '';
    }

    function clearPersonaForm() {
      ['firstName', 'lastName', 'nickname', 'age', 'location', 'niche', 'style', 'followers'].forEach(id => {
        document.getElementById(id).value = '';
      });
      document.getElementById('personaOutput').innerHTML = '';
      document.getElementById('personaPreview').style.display = 'none';
    }

    function updatePreview() {
      const firstName = document.getElementById('firstName').value.trim();
      const lastName = document.getElementById('lastName').value.trim();
      const nickname = document.getElementById('nickname').value.trim();
      const age = document.getElementById('age').value.trim();
      const platform = document.getElementById('platformSelect').value;
      const location = document.getElementById('location').value.trim();
      const niche = document.getElementById('niche').value.trim();
      const style = document.getElementById('style').value.trim();
      const followers = document.getElementById('followers').value.trim();

      if (age && location && niche && style) {
        document.getElementById('personaPreview').style.display = 'block';
        const nameStr = firstName || lastName ? `${firstName} ${lastName}`.trim() : '(AI-generated name)';
        const fakeUsername = nickname ? nickname : `(username based on AI)`;

        document.getElementById('previewUsername').innerText = `@${fakeUsername}`;
        document.getElementById('previewName').innerText = `${nameStr}, ${age}`;
        document.getElementById('previewBio').innerText = `${niche} | ${followers || 'New'} followers`;
        document.getElementById('previewPlatform').innerText = platform.toUpperCase();
        document.getElementById('previewLocation').innerText = location;
        document.getElementById('previewStyle').innerText = style;
      }
    }

    document.querySelectorAll('#firstName, #lastName, #nickname, #age, #location, #niche, #style, #followers, #platformSelect')
      .forEach(el => el.addEventListener('input', updatePreview));

    async function generatePersona() {
      const platform = document.getElementById('platformSelect').value;
      const firstName = document.getElementById('firstName').value.trim();
      const lastName = document.getElementById('lastName').value.trim();
      const nickname = document.getElementById('nickname').value.trim();
      const age = document.getElementById('age').value.trim();
      const location = document.getElementById('location').value.trim();
      const niche = document.getElementById('niche').value.trim();
      const style = document.getElementById('style').value.trim();
      const followers = document.getElementById('followers').value.trim();
      const output = document.getElementById('personaOutput');

      if (!age || !location || !niche || !style) {
        return alert("Please complete all required fields.");
      }

      output.innerHTML = 'üß† Generating persona...';

      try {
        const res = await fetch('/generate-persona', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({ platform, firstName, lastName, nickname, age, location, niche, style, followers })
        });

        const data = await res.json();
        if (data.success) {
          const { username, name, bio, profileImage } = data.persona;

          document.getElementById('personaPreview').style.display = 'block';
          document.getElementById('previewUsername').innerText = `@${username}`;
          document.getElementById('previewName').innerText = `${name}, ${age}`;
          document.getElementById('previewBio').innerText = bio || `${niche} | ${followers || 'New'} followers`;
          document.getElementById('previewPlatform').innerText = platform.toUpperCase();
          document.getElementById('previewLocation').innerText = location;
          document.getElementById('previewStyle').innerText = style;
          document.getElementById('profileImage').src = profileImage;

          output.innerHTML = '‚úÖ Persona generated.';
        } else {
          output.innerHTML = '‚ùå Failed to generate persona. Please try again.';
        }
      } catch (err) {
        console.error(err);
        output.innerHTML = '‚ùå Server error. Try again later.';
      }
    }
  </script>
</body>
</html>
